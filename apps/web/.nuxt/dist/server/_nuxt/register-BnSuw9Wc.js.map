{"version":3,"file":"register-BnSuw9Wc.js","sources":["../../../../pages/auth/register.vue"],"sourcesContent":["<template>\n  <div class=\"mx-auto max-w-2xl space-y-6\">\n    <h1 class=\"text-2xl font-semibold\">Create your Jangid portal</h1>\n    <p class=\"text-sm text-muted-foreground\">\n      Reserve your subdomain, publish a visiting card or brochure, and manage enquiries from one dashboard.\n    </p>\n    <form class=\"grid gap-4 md:grid-cols-2\" @submit.prevent=\"onSubmit\">\n      <label class=\"space-y-2 text-sm font-medium\" for=\"displayName\">\n        Full name\n        <input\n          id=\"displayName\"\n          v-model=\"form.displayName\"\n          type=\"text\"\n          required\n          autocomplete=\"name\"\n          class=\"w-full rounded-md border border-border bg-background px-3 py-2\"\n        />\n      </label>\n      <label class=\"space-y-2 text-sm font-medium\" for=\"email\">\n        Email address\n        <input\n          id=\"email\"\n          v-model=\"form.email\"\n          type=\"email\"\n          required\n          autocomplete=\"email\"\n          class=\"w-full rounded-md border border-border bg-background px-3 py-2\"\n        />\n      </label>\n      <label class=\"space-y-2 text-sm font-medium\" for=\"phone\">\n        Phone number\n        <input\n          id=\"phone\"\n          v-model=\"form.phone\"\n          type=\"tel\"\n          placeholder=\"Optional\"\n          class=\"w-full rounded-md border border-border bg-background px-3 py-2\"\n        />\n      </label>\n      <label class=\"space-y-2 text-sm font-medium\" for=\"slug\">\n        Desired subdomain\n        <div class=\"flex items-center rounded-md border border-border bg-background\">\n          <input\n            id=\"slug\"\n            v-model=\"form.slug\"\n            type=\"text\"\n            required\n            placeholder=\"rakesh\"\n            class=\"w-full rounded-l-md px-3 py-2\"\n          />\n          <span class=\"px-3 text-sm text-muted-foreground\">.jangid.co.in</span>\n        </div>\n      </label>\n      <label class=\"md:col-span-2 space-y-2 text-sm font-medium\" for=\"category\">\n        Category\n        <select\n          id=\"category\"\n          v-model=\"form.categoryId\"\n          class=\"w-full rounded-md border border-border bg-background px-3 py-2 disabled:opacity-60\"\n          :disabled=\"categoriesPending\"\n        >\n          <option value=\"\">Select a category</option>\n          <option\n            v-for=\"category in categories\"\n            :key=\"category.id\"\n            :value=\"category.id\"\n          >\n            {{ category.name }}\n          </option>\n        </select>\n        <p v-if=\"categoriesError\" class=\"text-xs text-red-500\">Failed to load categories. Please refresh and try again.</p>\n      </label>\n      <label class=\"md:col-span-2 space-y-2 text-sm font-medium\" for=\"password\">\n        Password\n        <input\n          id=\"password\"\n          v-model=\"form.password\"\n          type=\"password\"\n          required\n          autocomplete=\"new-password\"\n          class=\"w-full rounded-md border border-border bg-background px-3 py-2\"\n        />\n      </label>\n      <p v-if=\"error\" class=\"md:col-span-2 text-sm text-red-500\">{{ error }}</p>\n      <button\n        class=\"md:col-span-2 rounded-md bg-primary px-4 py-2 font-medium text-white disabled:cursor-not-allowed disabled:opacity-70\"\n        :disabled=\"loading\"\n      >\n        <span v-if=\"loading\">Submitting...</span>\n        <span v-else>Submit registration</span>\n      </button>\n    </form>\n    <p class=\"text-sm text-muted-foreground\">\n      Already registered?\n      <NuxtLink to=\"/auth/login\" class=\"text-primary hover:underline\">Login to continue</NuxtLink>\n    </p>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, reactive, watchEffect } from 'vue'\nimport { storeToRefs } from 'pinia'\nimport { useRouter, useRoute } from 'vue-router'\nimport { useRuntimeConfig, useAsyncData } from 'nuxt/app'\nimport { $fetch } from 'ofetch'\nimport { categoriesResponseSchema, type CategoryList } from '@jangid/shared'\nimport { useAuthStore } from '@/stores/auth'\n\nconst router = useRouter()\nconst route = useRoute()\nconst auth = useAuthStore()\nconst { loading, error, isAuthenticated } = storeToRefs(auth)\nconst runtimeConfig = useRuntimeConfig()\n\nconst { data: categoriesData, pending: categoriesPending, error: categoriesError } = await useAsyncData(\n  'categories',\n  async () => {\n    const response = await $fetch(`${runtimeConfig.public.apiBase}/categories`)\n    return categoriesResponseSchema.parse(response)\n  }\n)\n\nconst categories = computed<CategoryList>(() => categoriesData.value ?? [])\n\nconst form = reactive({\n  displayName: '',\n  email: '',\n  phone: '',\n  slug: '',\n  categoryId: '',\n  password: ''\n})\n\nwatchEffect(() => {\n  if (isAuthenticated.value) {\n    navigateAfterAuth()\n  }\n})\n\nconst onSubmit = async () => {\n  try {\n    await auth.register({\n      displayName: form.displayName,\n      email: form.email,\n      phone: form.phone || undefined,\n      slug: form.slug,\n      categoryId: form.categoryId || undefined,\n      password: form.password\n    })\n    navigateAfterAuth()\n  } catch (err) {\n    console.warn('registration failed', err)\n  }\n}\n\nfunction navigateAfterAuth() {\n  const redirect = (route.query.redirect as string) || '/dashboard'\n  router.push(redirect)\n}\n</script>\n"],"names":["_withAsyncContext","_ssrRenderAttrs","_mergeProps","_ssrRenderAttr","_unref","_ssrIncludeBooleanAttr","_ssrLooseContain","_ssrLooseEqual","_ssrRenderList","_ssrInterpolate","_push","_parent"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA4GA,UAAM,SAAS,UAAA;AACf,UAAM,QAAQ,SAAA;AACd,UAAM,OAAO,aAAA;AACb,UAAM,EAAE,SAAS,OAAO,gBAAA,IAAoB,YAAY,IAAI;AAC5D,UAAM,gBAAgB,iBAAA;AAEtB,UAAM,EAAE,MAAM,gBAAgB,SAAS,mBAAmB,OAAO,gBAAA,KAAoB,CAAA,QAAA,SAAA,IAAAA,iBAAA,YAAM;AAAA,MACzF;AAAA,MACA,YAAY;AACV,cAAM,WAAW,MAAM,OAAO,GAAG,cAAc,OAAO,OAAO,aAAa;AAC1E,eAAO,yBAAyB,MAAM,QAAQ;AAAA,MAChD;AAAA,IAAA,CACF;AAEA,UAAM,aAAa,SAAuB,MAAM,eAAe,SAAS,CAAA,CAAE;AAE1E,UAAM,OAAO,SAAS;AAAA,MACpB,aAAa;AAAA,MACb,OAAO;AAAA,MACP,OAAO;AAAA,MACP,MAAM;AAAA,MACN,YAAY;AAAA,MACZ,UAAU;AAAA,IAAA,CACX;AAED,gBAAY,MAAM;AAChB,UAAI,gBAAgB,OAAO;AACzB,0BAAA;AAAA,MACF;AAAA,IACF,CAAC;AAkBD,aAAS,oBAAoB;AAC3B,YAAM,WAAY,MAAM,MAAM,YAAuB;AACrD,aAAO,KAAK,QAAQ;AAAA,IACtB;;;mBA7JOC,eAAAC,WAAA,EAAA,OAAM,8BAAA,GAA6B,MAAA,CAAA,mWAUvBC,cAAA,SAAA,KAAK,WAAW,sNAWhBA,cAAA,SAAA,KAAK,KAAK,uNAWVA,cAAA,SAAA,KAAK,KAAK,8RAWRA,cAAA,SAAA,KAAK,IAAI,kYAeTC,MAAA,iBAAA,CAAiB,IAAA,cAAA,sBAFnBC,sBAAA,MAAA,QAAA,KAAK,UAAU,IAAfC,gBAAA,KAAK,YAAU,EAAA,IAAfC,cAAA,KAAK,YAAU,EAAA,CAAA,IAAA,cAAA;AAMHC,oBAAA,WAAA,QAAZ,aAAQ;sCAEd,SAAO,SAAS,EAAE,IARZH,sBAAA,MAAA,QAAA,KAAK,UAAU,IAAfC,gBAAA,KAAK,YAQJ,SAAS,EAAE,IARZC,cAAA,KAAK,YAQJ,SAAS,EAAE,CAAA,IAAA,cAAA,MAEhBE,eAAA,SAAS,IAAI;;;UAGXL,MAAA,eAAA,GAAe;;;;;AAMb,YAAA,mHAAAD,cAAA,SAAA,KAAK,QAAQ,CAAA,uIAAA;UAOjBC,MAAA,KAAA,GAAK;8EAAgDA,MAAA,KAAA,CAAK,CAAA,MAAA;AAAA;;;yKAGtDA,MAAA,OAAA,CAAO,IAAA,cAAA,EAAA,GAAA;UAENA,MAAA,OAAA,GAAO;;;;;;;QAMX,IAAG;AAAA,QAAc,OAAM;AAAA,MAAA;yBAAjC,CAA4F,GAAAM,QAAAC,UAAA,aAAA;;;;;8BAA5B,mBAAiB;AAAA,YAAA;AAAA;;;;;;;;;;;;;;"}
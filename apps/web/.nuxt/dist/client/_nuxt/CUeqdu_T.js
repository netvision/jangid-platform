import{_ as q}from"./BMpR3WZ8.js";import{e as R,j as U,s as B,y as D,z as I,k as E,l as F,c as a,a as s,g as f,d as r,m as i,v as u,A as P,u as l,F as L,r as M,t as x,p as T,b as $,w as j,q as z,x as J,$ as O,B as G,o as d}from"#entry";import{u as H,c as K}from"./BUmpmyj8.js";const Q={class:"mx-auto max-w-2xl space-y-6"},W={class:"space-y-2 text-sm font-medium",for:"displayName"},X={class:"space-y-2 text-sm font-medium",for:"email"},Y={class:"space-y-2 text-sm font-medium",for:"phone"},Z={class:"space-y-2 text-sm font-medium",for:"slug"},ee={class:"flex items-center rounded-md border border-border bg-background"},se={class:"md:col-span-2 space-y-2 text-sm font-medium",for:"category"},te=["disabled"],oe=["value"],re={key:0,class:"text-xs text-red-500"},ae={class:"md:col-span-2 space-y-2 text-sm font-medium",for:"password"},de={key:0,class:"md:col-span-2 text-sm text-red-500"},ne=["disabled"],ie={key:0},le={key:1},ue={class:"text-sm text-muted-foreground"},be=R({__name:"register",async setup(pe){let p,m;const w=z(),v=J(),c=U(),{loading:g,error:b,isAuthenticated:k}=B(c),_=G(),{data:h,pending:N,error:V}=([p,m]=D(async()=>H("categories",async()=>{const n=await O(`${_.public.apiBase}/categories`);return K.parse(n)})),p=await p,m(),p),S=I(()=>h.value??[]),t=E({displayName:"",email:"",phone:"",slug:"",categoryId:"",password:""});F(()=>{k.value&&y()});const A=async()=>{try{await c.register({displayName:t.displayName,email:t.email,phone:t.phone||void 0,slug:t.slug,categoryId:t.categoryId||void 0,password:t.password}),y()}catch(n){console.warn("registration failed",n)}};function y(){const n=v.query.redirect||"/dashboard";w.push(n)}return(n,e)=>{const C=q;return d(),a("div",Q,[e[16]||(e[16]=s("h1",{class:"text-2xl font-semibold"},"Create your Jangid portal",-1)),e[17]||(e[17]=s("p",{class:"text-sm text-muted-foreground"}," Reserve your subdomain, publish a visiting card or brochure, and manage enquiries from one dashboard. ",-1)),s("form",{class:"grid gap-4 md:grid-cols-2",onSubmit:T(A,["prevent"])},[s("label",W,[e[6]||(e[6]=r(" Full name ",-1)),i(s("input",{id:"displayName","onUpdate:modelValue":e[0]||(e[0]=o=>t.displayName=o),type:"text",required:"",autocomplete:"name",class:"w-full rounded-md border border-border bg-background px-3 py-2"},null,512),[[u,t.displayName]])]),s("label",X,[e[7]||(e[7]=r(" Email address ",-1)),i(s("input",{id:"email","onUpdate:modelValue":e[1]||(e[1]=o=>t.email=o),type:"email",required:"",autocomplete:"email",class:"w-full rounded-md border border-border bg-background px-3 py-2"},null,512),[[u,t.email]])]),s("label",Y,[e[8]||(e[8]=r(" Phone number ",-1)),i(s("input",{id:"phone","onUpdate:modelValue":e[2]||(e[2]=o=>t.phone=o),type:"tel",placeholder:"Optional",class:"w-full rounded-md border border-border bg-background px-3 py-2"},null,512),[[u,t.phone]])]),s("label",Z,[e[10]||(e[10]=r(" Desired subdomain ",-1)),s("div",ee,[i(s("input",{id:"slug","onUpdate:modelValue":e[3]||(e[3]=o=>t.slug=o),type:"text",required:"",placeholder:"rakesh",class:"w-full rounded-l-md px-3 py-2"},null,512),[[u,t.slug]]),e[9]||(e[9]=s("span",{class:"px-3 text-sm text-muted-foreground"},".jangid.co.in",-1))])]),s("label",se,[e[12]||(e[12]=r(" Category ",-1)),i(s("select",{id:"category","onUpdate:modelValue":e[4]||(e[4]=o=>t.categoryId=o),class:"w-full rounded-md border border-border bg-background px-3 py-2 disabled:opacity-60",disabled:l(N)},[e[11]||(e[11]=s("option",{value:""},"Select a category",-1)),(d(!0),a(L,null,M(S.value,o=>(d(),a("option",{key:o.id,value:o.id},x(o.name),9,oe))),128))],8,te),[[P,t.categoryId]]),l(V)?(d(),a("p",re,"Failed to load categories. Please refresh and try again.")):f("",!0)]),s("label",ae,[e[13]||(e[13]=r(" Password ",-1)),i(s("input",{id:"password","onUpdate:modelValue":e[5]||(e[5]=o=>t.password=o),type:"password",required:"",autocomplete:"new-password",class:"w-full rounded-md border border-border bg-background px-3 py-2"},null,512),[[u,t.password]])]),l(b)?(d(),a("p",de,x(l(b)),1)):f("",!0),s("button",{class:"md:col-span-2 rounded-md bg-primary px-4 py-2 font-medium text-white disabled:cursor-not-allowed disabled:opacity-70",disabled:l(g)},[l(g)?(d(),a("span",ie,"Submitting...")):(d(),a("span",le,"Submit registration"))],8,ne)],32),s("p",ue,[e[15]||(e[15]=r(" Already registered? ",-1)),$(C,{to:"/auth/login",class:"text-primary hover:underline"},{default:j(()=>[...e[14]||(e[14]=[r("Login to continue",-1)])]),_:1})])])}}});export{be as default};
